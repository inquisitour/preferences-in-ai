# Code Documentation

This document describes the structure of the codebase.

---

## `core/`

- **`types.py`**
  - `MultiIssueElection`: stores approval preferences as a numpy array  
    (shape: n_voters × n_issues × n_candidates).
  - `Outcome`: stores winners per issue.
  - Welfare functions:
    - `utilitarian_welfare`
    - `egalitarian_welfare`
    - `nash_welfare`

---

## `statistical_cultures/`

Preference generators for experiments:

- **`p_ic.py`**
  - `PICConfig`: config for per-issue impartial culture.
  - `sample_p_ic`: generates elections under p-IC.

- **`disjoint.py`**
  - `DisjointConfig`: voters partitioned into groups with aligned preferences.
  - `sample_disjoint`: generates elections.

- **`resampling.py`**
  - `ResamplingConfig`: $(p, \phi)$-resampling with correlation.
  - `sample_resampling`: generates elections.

- **`hamming_noise.py`**
  - `HammingConfig`: wraps a base culture (`p_ic`, `resampling`, or `disjoint`) and adds noise.
  - `sample_hamming`: samples from base and flips approvals with probability `noise_prob`.

---

## `voting_rules/`

- **`utilitarian.py`** – Sequential utilitarian rule.
- **`sequential_thiele.py`** – Implements PAV and CC via Thiele scores.
- **`owa.py`** – Implements OWA-based rules (Leximin, Mean).

Each rule returns an `Outcome`.

---

## `free_riding/`

- **`detector.py`**
  - `detect_free_riding`: simulates manipulations and checks if they succeed or harm.

- **`risk.py`**
  - `evaluate_risk`: wraps detector results into summary statistics.

- **`welfare.py`**
  - `welfare_summary`: computes utilitarian, egalitarian, Nash welfare.

---

## `experiments/`

- **`run_experiments.py`**
  - Runs full experiment batches across cultures, rules, and seeds.
  - Saves results as CSV + LaTeX.

- **`plot_results.py`**
  - Generates welfare and risk comparison plots (per culture + global).

---

## `report/`

- **`report.tex`** – LaTeX report source.
- **`tables/combined.tex`** – Generated results table.
- **`figures/`** – Plots generated by `plot_results.py`.

---

## `tests/`

Pytest-based unit tests for cultures, rules, and free-riding detector.

Run with:

```bash
pytest tests/
```

---
